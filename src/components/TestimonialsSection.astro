---
import Card from "./Card.astro";
import SectionHeading from "./SectionHeading.astro";

interface Props {
  background?: "white" | "blue-white";
  cardVariant?: "default" | "blue";
}

const { background = "blue-white", cardVariant = "default" } = Astro.props;
const bgClass = background === "white" ? "bg-white" : "bg-blue-white";

const testimonials = [
	{
		quote: '"El equipo de Dental Gran Avenida es increíble. Me trataron con mucho profesionalismo y el resultado fue exactamente lo que esperaba."',
		name: 'María González',
		detail: 'Paciente desde 2021',
	},
	{
		quote: '"Tenía mucho miedo al dentista, pero aquí me explicaron cada paso. El tratamiento fue completamente sin dolor. Los recomiendo al 100%."',
		name: 'Carlos Muñoz',
		detail: 'Paciente desde 2022',
	},
	{
		quote: '"La tecnología que tienen es de primer nivel. Me hicieron el scanner 3D y los implantes quedaron perfectos. Excelente atención."',
		name: 'Ana Pérez',
		detail: 'Paciente desde 2020',
	},
	{
		quote: '"Llevo a toda mi familia aquí. La atención es personalizada y los precios son justos. Muy contentos con los resultados."',
		name: 'Roberto Silva',
		detail: 'Paciente desde 2019',
	},
	{
		quote: '"Me hicieron un blanqueamiento y quedó espectacular. El proceso fue rápido y sin molestias. Totalmente recomendado."',
		name: 'Carmen Rojas',
		detail: 'Paciente desde 2023',
	},
	{
		quote: '"La ortodoncia que me pusieron cambió mi sonrisa. El equipo es muy profesional y siempre dispuesto a resolver dudas."',
		name: 'Diego Fernández',
		detail: 'Paciente desde 2021',
	},
	{
		quote: '"Atendieron a mi hijo con mucha paciencia. Ahora va contento al dentista. Gracias por la excelente labor."',
		name: 'Patricia López',
		detail: 'Paciente desde 2022',
	},
	{
		quote: '"Urgencia dental en la noche y me atendieron al día siguiente. Eso habla del compromiso con sus pacientes."',
		name: 'Andrés Martínez',
		detail: 'Paciente desde 2020',
	},
];
---

<section class:list={[bgClass, 'py-24 w-full overflow-x-hidden']}>
	<div class="container-site flex flex-col lg:flex-row items-center lg:items-center gap-8 lg:gap-20">

		<div class="flex-1 min-w-0 w-full flex flex-col items-center lg:items-start justify-center text-center lg:text-left" data-sal="slide-up" data-sal-duration="400">
			<SectionHeading
				label="Testimonios"
				title="Nuestros pacientes nos prefieren"
				description="Miles de familias de El Bosque y sus alrededores confían en Dental Gran Avenida para el cuidado de su salud bucal."
				centerOnMobile
			/>
		</div>

		<div class="flex flex-col gap-6 flex-1 min-w-0 w-full overflow-hidden" data-sal="slide-up" data-sal-duration="400" data-sal-delay="100">

			<div class="flex items-center justify-center lg:justify-end gap-2">
				<button
					type="button"
					id="testimonials-prev"
					aria-label="Anterior"
					class:list={[
						"group flex items-center justify-center size-10 rounded-full hover:bg-french-ultramarine transition-colors shrink-0 cursor-pointer touch-manipulation focus-ring",
						cardVariant === "blue" ? "bg-blue-white" : "bg-white",
					]}
				>
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 8" class="w-4 h-auto rotate-180 fill-body group-hover:fill-white transition-colors" aria-hidden="true">
						<path d="M17.354 4.354a.5.5 0 0 0 0-.708L14.172.464a.5.5 0 1 0-.708.708L16.293 4l-2.829 2.828a.5.5 0 1 0 .708.708l3.182-3.182ZM0 4.5h17v-1H0v1Z"/>
					</svg>
				</button>
				<button
					type="button"
					id="testimonials-next"
					aria-label="Siguiente"
					class:list={[
						"group flex items-center justify-center size-10 rounded-full hover:bg-french-ultramarine transition-colors shrink-0 cursor-pointer touch-manipulation focus-ring",
						cardVariant === "blue" ? "bg-blue-white" : "bg-white",
					]}
				>
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 8" class="w-4 h-auto fill-body group-hover:fill-white transition-colors" aria-hidden="true">
						<path d="M17.354 4.354a.5.5 0 0 0 0-.708L14.172.464a.5.5 0 1 0-.708.708L16.293 4l-2.829 2.828a.5.5 0 1 0 .708.708l3.182-3.182ZM0 4.5h17v-1H0v1Z"/>
					</svg>
				</button>
			</div>

			<div
				id="testimonials-scroll"
				role="region"
				aria-label="Testimonios de pacientes"
				tabindex="0"
				class="flex gap-6 overflow-x-auto overflow-y-hidden scroll-smooth snap-x snap-mandatory pb-2 scrollbar-thin"
			>
				{testimonials.map((t) => (
					<Card variant={cardVariant === "blue" ? "blue" : "default"} class="shrink-0 min-w-[280px] w-72 snap-start">
						<div class="flex flex-col gap-6">
							<div class="flex gap-1" aria-label="5 de 5 estrellas">
								{Array.from({ length: 5 }).map(() => (
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="size-4 fill-amber-400" aria-hidden="true">
										<path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
									</svg>
								))}
							</div>
							<p class="text-base text-body">{t.quote}</p>
						</div>
						<div class="flex flex-col">
							<p class="text-base font-medium text-body">{t.name}</p>
							<p class="text-sm text-body/70">{t.detail}</p>
						</div>
					</Card>
				))}
			</div>

		</div>
	</div>
</section>

<script is:inline>
	document.addEventListener('DOMContentLoaded', () => {
		const scrollEl = document.getElementById('testimonials-scroll');
		const prevBtn = document.getElementById('testimonials-prev');
		const nextBtn = document.getElementById('testimonials-next');
		const scrollAmount = 304;

		if (scrollEl && prevBtn && nextBtn) {
			prevBtn.addEventListener('click', (e) => {
				e.preventDefault();
				scrollEl.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
			});
			nextBtn.addEventListener('click', (e) => {
				e.preventDefault();
				scrollEl.scrollBy({ left: scrollAmount, behavior: 'smooth' });
			});
		}
	});
</script>
