---
import { Image } from 'astro:assets';
import { config } from '../config';
import SectionHeading from './SectionHeading.astro';
import Button from './Button.astro';
import mapImage from '../assets/images/map-simple.png';

interface Props {
	background?: 'white' | 'blue-white';
}

const { background = 'blue-white' } = Astro.props;
const bgClass = background === 'white' ? 'bg-white' : 'bg-blue-white';
---

<section class:list={[bgClass, 'py-24 w-full']}>
	<div class="container-site flex flex-col lg:flex-row items-center gap-12 lg:gap-20">

		<div class="flex-1 flex flex-col gap-6 items-start order-2 lg:order-1" data-sal="slide-up" data-sal-duration="400">
			<SectionHeading
				title="Estamos en la comuna de El Bosque"
				description="A solo pasos del paradero PG-12 y Estación de Metro El Bosque y Observatorio. Con estacionamiento gratuito disponible para pacientes."
			/>
			<Button
				href={config.location.mapsUrl}
				label="Ver Google Maps"
				variant="primary"
				target="_blank"
			/>
		</div>

		<div class="flex-1 w-full order-1 lg:order-2" data-sal="slide-up" data-sal-duration="400" data-sal-delay="100">
			<a
				id="map-wrapper"
				href={config.location.mapsUrl}
				target="_blank"
				rel="noopener noreferrer"
				class="map-wrapper relative rounded-2xl overflow-hidden bg-white w-full aspect-4/3 lg:aspect-auto lg:h-[460px] block"
				aria-label="Ver ubicación en Google Maps"
			>
				<div class="absolute inset-0 bg-white/80" aria-hidden="true" />
				<Image
					src={mapImage}
					alt="Mapa de ubicación de Dental Gran Avenida, Gran Avenida 10063, El Bosque"
					class="absolute inset-0 w-full h-full object-contain p-6"
				/>
				<div class="map-overlay absolute inset-0 bg-black/0 transition-colors duration-300 pointer-events-none" aria-hidden="true" />
				<span id="map-label" class="map-label" aria-hidden="true">
					Ver Google Maps
				</span>
			</a>
		</div>

	</div>
</section>

<style>
	.map-wrapper {
		cursor: none;
	}

	.map-label {
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
		pointer-events: none;
		z-index: 10;
		font-size: 0.875rem;
		font-weight: 600;
		color: white;
		text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
		white-space: nowrap;
		opacity: 0;
		transition: opacity 0.2s ease;
	}

	.map-wrapper.is-hovering .map-label {
		position: fixed;
		transform: translate(-50%, -50%);
		opacity: 1;
	}

	.map-wrapper.is-hovering .map-overlay {
		background-color: rgba(0, 0, 0, 0.4);
	}
</style>

<script>
	const wrapper = document.getElementById('map-wrapper');
	const label = document.getElementById('map-label');

	if (wrapper && label) {
		wrapper.addEventListener('mouseenter', () => {
			wrapper.classList.add('is-hovering');
		});

		wrapper.addEventListener('mouseleave', () => {
			wrapper.classList.remove('is-hovering');
			label.style.left = '';
			label.style.top = '';
		});

		wrapper.addEventListener('mousemove', (e: MouseEvent) => {
			if (wrapper.classList.contains('is-hovering')) {
				label.style.left = `${e.clientX}px`;
				label.style.top = `${e.clientY}px`;
			}
		});
	}
</script>
